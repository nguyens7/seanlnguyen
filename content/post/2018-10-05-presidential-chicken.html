---
title: Presidential Chicken
author: Sean Nguyen
date: '2018-10-05'
slug: presidential-chicken
categories:
  - R

tags:
  - Scraping
  - Lubridate
  - Shiny
  - Wordcloud
header:
  caption: 'Wordcloud of top menu items at MSU dining halls from 10/5/18 - 10/15/18'
  image: 'headers/eatatstate_wordcloud.png'
---



<p>I remember back in undergrad when I visited my friends at Michigan State and they took me to the residential dining hall and how I had typical dorm food like salad bar, burgers, hot dogs, fries etc. The dining halls have improved drastically since then and now the undergraduate students have it great with so many options available to them.</p>
<div id="eat-at-state" class="section level1">
<h1>Eat at State</h1>
<p>A common theme in the lab is to ask one another what do you have for lunch today? Sometimes we don’t bring anything and our options are to go to the international center food court, the restaurants on Grand River or the residential dining halls. MSU employees have a great option to buy admission into the dining hall at a discounted rate so I always tag along with them so they can swipe me in. We typically preview the menus at <a href="https://eatatstate.msu.edu/">eatatstate.msu.edu</a> and will choose to go to the dining hall one with the best menu. One of my favorite dishes from the cafeteria is Presidential Chicken which is a chicken dish with an alfredo like sauce with vegetables and is wrapped up in puff pastry envelope. It tastes great and is exponentially better than the food I’ve had at weddings. We haven’t seen the dish on the menu in well over a year so I decided to see if I could scrape the menus and make a quick shiny dashboard to figure out the next time they would serve it.</p>
<pre class="r"><code>library(rvest)
library(tidyverse)
library(lubridate)</code></pre>
</div>
<div id="generate-urls" class="section level1">
<h1>Generate urls</h1>
<pre class="r"><code>domain &lt;- &quot;https://eatatstate.msu.edu/menu/&quot;
shaw &lt;- &quot;The%20Vista%20at%20Shaw/all/&quot;
sny_phy &lt;- &quot;The%20Gallery%20at%20Snyder%20Phillips/all/&quot;
landon &lt;- &quot;Heritage%20Commons%20at%20Landon/all/&quot;

dining_halls &lt;- c(shaw, sny_phy, landon)

# List of dates
future_date &lt;- ymd(today()) + days(10)
dates &lt;- seq(ymd(today()), future_date, by = &#39;day&#39;)

# Number of dining halls
dining_hall_no &lt;- length(dining_halls) %&gt;%
  unlist()

# Create lunch urls
day_url &lt;- dining_halls %&gt;% 
  map(~paste(domain, .x, dates, sep = &quot;&quot;)) %&gt;%
  unlist()

dining_halls</code></pre>
<pre><code>## [1] &quot;The%20Vista%20at%20Shaw/all/&quot;               
## [2] &quot;The%20Gallery%20at%20Snyder%20Phillips/all/&quot;
## [3] &quot;Heritage%20Commons%20at%20Landon/all/&quot;</code></pre>
<pre class="r"><code>dates</code></pre>
<pre><code>##  [1] &quot;2018-10-05&quot; &quot;2018-10-06&quot; &quot;2018-10-07&quot; &quot;2018-10-08&quot; &quot;2018-10-09&quot;
##  [6] &quot;2018-10-10&quot; &quot;2018-10-11&quot; &quot;2018-10-12&quot; &quot;2018-10-13&quot; &quot;2018-10-14&quot;
## [11] &quot;2018-10-15&quot;</code></pre>
<pre class="r"><code>day_url %&gt;% 
  head()</code></pre>
<pre><code>## [1] &quot;https://eatatstate.msu.edu/menu/The%20Vista%20at%20Shaw/all/2018-10-05&quot;
## [2] &quot;https://eatatstate.msu.edu/menu/The%20Vista%20at%20Shaw/all/2018-10-06&quot;
## [3] &quot;https://eatatstate.msu.edu/menu/The%20Vista%20at%20Shaw/all/2018-10-07&quot;
## [4] &quot;https://eatatstate.msu.edu/menu/The%20Vista%20at%20Shaw/all/2018-10-08&quot;
## [5] &quot;https://eatatstate.msu.edu/menu/The%20Vista%20at%20Shaw/all/2018-10-09&quot;
## [6] &quot;https://eatatstate.msu.edu/menu/The%20Vista%20at%20Shaw/all/2018-10-10&quot;</code></pre>
<pre class="r"><code># Create dinner urls
dinner &lt;- &quot;?field_mealtime_target_id=191&quot;

night_url &lt;- dining_halls %&gt;% 
  map(~paste(domain, .x, dates, dinner, sep = &quot;&quot;)) %&gt;%
  unlist()

# Combine url list
all_url &lt;- c(day_url, night_url)

all_url %&gt;% 
  head()</code></pre>
<pre><code>## [1] &quot;https://eatatstate.msu.edu/menu/The%20Vista%20at%20Shaw/all/2018-10-05&quot;
## [2] &quot;https://eatatstate.msu.edu/menu/The%20Vista%20at%20Shaw/all/2018-10-06&quot;
## [3] &quot;https://eatatstate.msu.edu/menu/The%20Vista%20at%20Shaw/all/2018-10-07&quot;
## [4] &quot;https://eatatstate.msu.edu/menu/The%20Vista%20at%20Shaw/all/2018-10-08&quot;
## [5] &quot;https://eatatstate.msu.edu/menu/The%20Vista%20at%20Shaw/all/2018-10-09&quot;
## [6] &quot;https://eatatstate.msu.edu/menu/The%20Vista%20at%20Shaw/all/2018-10-10&quot;</code></pre>
<div id="dates-and-time" class="section level3">
<h3>Dates and Time</h3>
<pre class="r"><code># Date
date &lt;- rep(dates, times = 2 * dining_hall_no)

# Cafe

no_dates &lt;- length(dates) 
names &lt;- str_replace_all(dining_halls, &quot;%20|\\/all\\/&quot;,&quot; &quot;)
cafe &lt;- rep(names, each = no_dates, times = 2)

# Time
time &lt;- rep(c(&quot;Lunch&quot;, &quot;Dinner&quot;), each = no_dates * dining_hall_no)
time</code></pre>
<pre><code>##  [1] &quot;Lunch&quot;  &quot;Lunch&quot;  &quot;Lunch&quot;  &quot;Lunch&quot;  &quot;Lunch&quot;  &quot;Lunch&quot;  &quot;Lunch&quot; 
##  [8] &quot;Lunch&quot;  &quot;Lunch&quot;  &quot;Lunch&quot;  &quot;Lunch&quot;  &quot;Lunch&quot;  &quot;Lunch&quot;  &quot;Lunch&quot; 
## [15] &quot;Lunch&quot;  &quot;Lunch&quot;  &quot;Lunch&quot;  &quot;Lunch&quot;  &quot;Lunch&quot;  &quot;Lunch&quot;  &quot;Lunch&quot; 
## [22] &quot;Lunch&quot;  &quot;Lunch&quot;  &quot;Lunch&quot;  &quot;Lunch&quot;  &quot;Lunch&quot;  &quot;Lunch&quot;  &quot;Lunch&quot; 
## [29] &quot;Lunch&quot;  &quot;Lunch&quot;  &quot;Lunch&quot;  &quot;Lunch&quot;  &quot;Lunch&quot;  &quot;Dinner&quot; &quot;Dinner&quot;
## [36] &quot;Dinner&quot; &quot;Dinner&quot; &quot;Dinner&quot; &quot;Dinner&quot; &quot;Dinner&quot; &quot;Dinner&quot; &quot;Dinner&quot;
## [43] &quot;Dinner&quot; &quot;Dinner&quot; &quot;Dinner&quot; &quot;Dinner&quot; &quot;Dinner&quot; &quot;Dinner&quot; &quot;Dinner&quot;
## [50] &quot;Dinner&quot; &quot;Dinner&quot; &quot;Dinner&quot; &quot;Dinner&quot; &quot;Dinner&quot; &quot;Dinner&quot; &quot;Dinner&quot;
## [57] &quot;Dinner&quot; &quot;Dinner&quot; &quot;Dinner&quot; &quot;Dinner&quot; &quot;Dinner&quot; &quot;Dinner&quot; &quot;Dinner&quot;
## [64] &quot;Dinner&quot; &quot;Dinner&quot; &quot;Dinner&quot;</code></pre>
</div>
<div id="scrape" class="section level3">
<h3>Scrape</h3>
<pre class="r"><code># Menu 
menu &lt;- all_url %&gt;%   
 map(~read_html(.x) %&gt;% 
      html_nodes(&quot;.meal-title&quot;) %&gt;% 
      html_text()) 

menu[1]</code></pre>
<pre><code>## [[1]]
##  [1] &quot;Chicken Pasta Primavera&quot;          
##  [2] &quot;Corn Muffin&quot;                      
##  [3] &quot;Cuban Black Bean and Pork Chili &quot; 
##  [4] &quot;Chocolate Chip Cookie&quot;            
##  [5] &quot;Double Chocolate Chip Cookie&quot;     
##  [6] &quot;M&amp;M Cookie&quot;                       
##  [7] &quot;Snickerdoodle Cookie&quot;             
##  [8] &quot;Eggplant Lentil Chili&quot;            
##  [9] &quot;Fruit Bowl&quot;                       
## [10] &quot;Smokey BBQ Tofu Sandwich&quot;         
## [11] &quot;Steamed Corn&quot;                     
## [12] &quot;Sweet Potato Fries&quot;               
## [13] &quot;Wild and Jasmine Rice Blend&quot;      
## [14] &quot;Beef Hot Dog&quot;                     
## [15] &quot;Breaded Chicken Patty&quot;            
## [16] &quot;Burger Bar&quot;                       
## [17] &quot;French Fries&quot;                     
## [18] &quot;Grilled Cheese&quot;                   
## [19] &quot;Baked Fresh Fish&quot;                 
## [20] &quot;Breadsmith&#39;s Bakery Peasant Roll&quot; 
## [21] &quot;Honey Butter&quot;                     
## [22] &quot;Orange Mustard Glaze&quot;             
## [23] &quot;Roasted Red Potatoes&quot;             
## [24] &quot;Sauteed Capri Vegetables&quot;         
## [25] &quot;Brown Rice&quot;                       
## [26] &quot;Guinness Lamb Stew&quot;               
## [27] &quot;Steamed Baby Carrots with Parsley&quot;
## [28] &quot;Basmati Rice&quot;                     
## [29] &quot;Crab Rangoons&quot;                    
## [30] &quot;Lo Mein &quot;                         
## [31] &quot;Peking Pork &quot;                     
## [32] &quot;Singapore Broth&quot;                  
## [33] &quot;Tofu&quot;</code></pre>
</div>
<div id="create-a-data-frame" class="section level3">
<h3>Create a data frame</h3>
<pre class="r"><code>food &lt;- tibble(date, cafe, time, menu) %&gt;% 
  unnest(menu) 

food %&gt;% 
  head(15)</code></pre>
<pre><code>## # A tibble: 15 x 4
##    date       cafe                 time  menu                              
##    &lt;date&gt;     &lt;chr&gt;                &lt;chr&gt; &lt;chr&gt;                             
##  1 2018-10-05 &quot;The Vista at Shaw &quot; Lunch Chicken Pasta Primavera           
##  2 2018-10-05 &quot;The Vista at Shaw &quot; Lunch Corn Muffin                       
##  3 2018-10-05 &quot;The Vista at Shaw &quot; Lunch &quot;Cuban Black Bean and Pork Chili &quot;
##  4 2018-10-05 &quot;The Vista at Shaw &quot; Lunch Chocolate Chip Cookie             
##  5 2018-10-05 &quot;The Vista at Shaw &quot; Lunch Double Chocolate Chip Cookie      
##  6 2018-10-05 &quot;The Vista at Shaw &quot; Lunch M&amp;M Cookie                        
##  7 2018-10-05 &quot;The Vista at Shaw &quot; Lunch Snickerdoodle Cookie              
##  8 2018-10-05 &quot;The Vista at Shaw &quot; Lunch Eggplant Lentil Chili             
##  9 2018-10-05 &quot;The Vista at Shaw &quot; Lunch Fruit Bowl                        
## 10 2018-10-05 &quot;The Vista at Shaw &quot; Lunch Smokey BBQ Tofu Sandwich          
## 11 2018-10-05 &quot;The Vista at Shaw &quot; Lunch Steamed Corn                      
## 12 2018-10-05 &quot;The Vista at Shaw &quot; Lunch Sweet Potato Fries                
## 13 2018-10-05 &quot;The Vista at Shaw &quot; Lunch Wild and Jasmine Rice Blend       
## 14 2018-10-05 &quot;The Vista at Shaw &quot; Lunch Beef Hot Dog                      
## 15 2018-10-05 &quot;The Vista at Shaw &quot; Lunch Breaded Chicken Patty</code></pre>
<p>I made it on Monday this week and to my surprise I saw that they would be serving it today for dinner in Landon!</p>
<pre class="r"><code>food %&gt;% 
  filter( str_detect(menu, &quot;Presidential&quot;)) </code></pre>
<pre><code>## # A tibble: 1 x 4
##   date       cafe                          time   menu                
##   &lt;date&gt;     &lt;chr&gt;                         &lt;chr&gt;  &lt;chr&gt;               
## 1 2018-10-05 &quot;Heritage Commons at Landon &quot; Dinner Presidential Chicken</code></pre>
<p>We can also filter to look at the menu for today only.</p>
<pre class="r"><code>food %&gt;% 
  filter(date == today())</code></pre>
<pre><code>## # A tibble: 288 x 4
##    date       cafe                 time  menu                              
##    &lt;date&gt;     &lt;chr&gt;                &lt;chr&gt; &lt;chr&gt;                             
##  1 2018-10-05 &quot;The Vista at Shaw &quot; Lunch Chicken Pasta Primavera           
##  2 2018-10-05 &quot;The Vista at Shaw &quot; Lunch Corn Muffin                       
##  3 2018-10-05 &quot;The Vista at Shaw &quot; Lunch &quot;Cuban Black Bean and Pork Chili &quot;
##  4 2018-10-05 &quot;The Vista at Shaw &quot; Lunch Chocolate Chip Cookie             
##  5 2018-10-05 &quot;The Vista at Shaw &quot; Lunch Double Chocolate Chip Cookie      
##  6 2018-10-05 &quot;The Vista at Shaw &quot; Lunch M&amp;M Cookie                        
##  7 2018-10-05 &quot;The Vista at Shaw &quot; Lunch Snickerdoodle Cookie              
##  8 2018-10-05 &quot;The Vista at Shaw &quot; Lunch Eggplant Lentil Chili             
##  9 2018-10-05 &quot;The Vista at Shaw &quot; Lunch Fruit Bowl                        
## 10 2018-10-05 &quot;The Vista at Shaw &quot; Lunch Smokey BBQ Tofu Sandwich          
## # ... with 278 more rows</code></pre>
</div>
</div>
<div id="wordcloud" class="section level1">
<h1>Wordcloud</h1>
<pre class="r"><code>library(tidytext)
library(wordcloud)
library(RColorBrewer)

# MSU pallete colors  
pal &lt;- c(&quot;#97A2A2&quot;,&quot;#F08521&quot;,&quot;#6E005F&quot;,&quot;#F08521&quot;,&quot;#97A2A2&quot;,&quot;#0DB14B&quot;)

set.seed(1234)

food %&gt;% 
  unnest_tokens(menu, menu) %&gt;% 
  count(menu, sort = TRUE) %&gt;% 
  rename(word = menu) %&gt;% 
  anti_join(stop_words, by = &quot;word&quot;) %&gt;% 
  with(wordcloud(word, n, random.order = FALSE, max.words = 40, color = pal,fixed.asp = TRUE))</code></pre>
<p><img src="/post/2018-10-05-presidential-chicken_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
</div>
<div id="shiny-dashboard" class="section level1">
<h1>Shiny Dashboard</h1>
<p>Now that we learned how to make a wordcloud, scrape the menu into a tidy data frame we can work on making a interact with the data by making a shiny dashboard.</p>
<div class="figure">
<img src="https://media.giphy.com/media/1evFtMR37i8VXzMwtJ/giphy.gif" alt="Eat at State Shiny Dashboard" />
<p class="caption">Eat at State Shiny Dashboard</p>
</div>
</div>
